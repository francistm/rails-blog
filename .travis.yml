language: ruby

rvm:
  - 2.3.1

env:
  - SKIP_QINIU_UPLOAD=true
  - SKIP_QINIU_UPLOAD=false

script:
  - bundle exec rspec ./spec

services:
  - mysql

before_script:
  - export DB_USERNAME=root
  - export DB_PASSWORD=""
  - mysql -e 'CREATE DATABASE IF NOT EXISTS rails_blog_test;' -uroot
  - RAILS_ENV=test bundle exec rake db:schema:load

matrix:
  allow_failures:
    - env: SKIP_QINIU_UPLOAD=false